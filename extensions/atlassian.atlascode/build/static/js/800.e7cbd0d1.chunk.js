"use strict";(self.webpackChunkatlascode=self.webpackChunkatlascode||[]).push([[800],{7135:(e,t,a)=>{a.d(t,{S:()=>AttachmentForm,g:()=>d});var n=a(73613),s=a(90585),l=a(42870),i=a(52196),r=a(19412),c=a(96540),o=a(10824);const Delete=e=>c.createElement("div",{className:"ac-delete",onClick:()=>e.delfunc(e.file)},c.createElement(s.A,{label:"trash"})),Thumbnail=e=>e.file.isImage?c.createElement("div",{className:"ac-attachment-thumb-img-inline"},c.createElement("img",{src:e.file.preview})):c.createElement("div",{className:"ac-attachment-thumb-img-inline"},c.createElement(n.A,{label:"no preview"})),Filename=e=>c.createElement("p",{style:{display:"inline"}},e.file.name),Size=e=>{const t="number"===typeof e.file.size?e.file.size:parseFloat(e.file.size),a=(0,r.O)(t);return c.createElement("p",{style:{display:"inline"}},a)},d=["image/gif","image/jpeg","image/png","image/webp"],m=[],filesReducer=(e,t)=>{switch(t.type){case"addFiles":return[...e,...t.payload];case"removeFile":return e.filter((e=>e.path?e.path!==t.payload.path:e.name!==t.payload.name));case"reset":return[]}},AttachmentForm=({field:e,onFilesChanged:t,isInline:a})=>{const[r,u]=(0,c.useReducer)(filesReducer,m),{getRootProps:p,getInputProps:h}=(0,o.VB)({onDrop:e=>{const t=e.map((e=>d.includes(e.type)?Object.assign(e,{preview:URL.createObjectURL(e),isImage:!0}):Object.assign(e,{preview:"",isImage:!1})));u({type:"addFiles",payload:t})}});return(0,c.useEffect)((()=>()=>{r.forEach((e=>URL.revokeObjectURL(e.preview)))}),[r]),(0,c.useEffect)((()=>{t(r,e)}),[e,r,t]),a?((e,t,a,n)=>c.createElement("div",{className:"ac-attachment-container"},c.createElement("div",{...a({className:"ac-attachment-dropzone-inline"})},c.createElement("div",{className:"ac-attachment-instructions"},c.createElement("div",{className:"ac-attachment-filesbg-inline"},c.createElement(l.A,{label:"upload"})),c.createElement("div",{className:"ac-attachment-drag-and-button"},c.createElement("div",{className:"ac-attachment-drag-text-inline"},c.createElement("span",null,"Drop files or click to browse")),c.createElement("input",{...n()})))),c.createElement(i.A,{columns:[Thumbnail,Filename,Size,Delete],columnWidths:["36px","100%","150px","50px"],items:e.map((e=>({id:e.path,content:{file:e,delfunc:()=>t({type:"removeFile",payload:e})}})))})))(r,u,p,h):((e,t,a,l)=>c.createElement("div",{className:"ac-attachment-container"},c.createElement("div",{...a({className:"ac-attachment-dropzone"})},c.createElement("div",{className:"ac-attachment-instructions"},c.createElement("img",{className:"ac-attachment-filesbg",src:"images/files-bg.png"}),c.createElement("div",{className:"ac-attachment-drag-and-button"},c.createElement("div",{className:"ac-attachment-drag-text"},c.createElement("span",null,"Drag and drop your files anywhere or")),c.createElement("input",{...l()}),c.createElement("p",{className:"ac-attachment-upload-button"},"Click to upload")))),c.createElement("div",{className:"ac-attachment-thumbs-container"},e.map((e=>c.createElement("div",{className:"ac-attachment-thumb",key:e.name},c.createElement("div",{className:"ac-attachment-thumb-item"},c.createElement("div",{className:"ac-attachment-thumb-inner"},c.createElement("div",{className:"ac-attachment-thumb-img-wrapper"},e.isImage&&c.createElement("img",{src:e.preview,className:"ac-attachment-thumb-img"}),!e.isImage&&c.createElement(n.A,{label:"no preview"}),c.createElement("div",{className:"ac-attachment-overlay-container"},c.createElement("div",{className:"ac-attachment-overlay"},c.createElement("div",{className:"ac-attachment-filename-container"},c.createElement("div",{className:"ac-attachment-filename"},e.name)),c.createElement("div",{className:"ac-attachment-delete-container"},c.createElement("div",{className:"ac-attachment-delete",onClick:()=>t({type:"removeFile",payload:e})},c.createElement(s.A,{label:"trash"}))))))))))))))(r,u,p,h)}},22576:(e,t,a)=>{a.d(t,{f:()=>readFilesContentAsync});var n=a(63279);async function getFileWithContent(e){return e.fileContent=await function readFile(e){return new Promise(((t,a)=>{const s=new FileReader;s.onerror=()=>a(s.error||new Error(`Error occurred reading file: ${e.name}`)),s.onloadend=()=>t((0,n.l)(s.result)),s.readAsArrayBuffer(e)}))}(e),e}function readFilesContentAsync(e){return Promise.all(e.map((e=>getFileWithContent(e))))}},47292:(e,t,a)=>{a.d(t,{BQ:()=>IssueSuggestionOption,HP:()=>IssueSuggestionValue,SY:()=>valueFuncForValueType,iS:()=>selectComponentType,nM:()=>labelFuncForValueType,th:()=>getComponentsForValueType,ye:()=>o});var n=a(85832),s=a(66278),l=a(70246),i=a(55677),r=a(96540),c=a(79402);const returnOptionOrValueFunc=e=>{let t="";return"object"===typeof e?t=e.value?e.value:JSON.stringify(e):"string"===typeof e?t=e:"number"===typeof e&&(t=""+e),t},returnValueOrNameFunc=e=>{let t="";return t=e.value?e.value:e.name?e.name:JSON.stringify(e),t},returnOptionOrLabelFunc=e=>{let t="";return"object"===typeof e?t=e.label?e.label:JSON.stringify(e):"string"===typeof e&&(t=e),t},returnIdFunc=e=>e.id,returnNameFunc=e=>e.label?e.label:e.name,returnValueFunc=e=>e.value,returnDisplayNameFunc=e=>e.label?e.label:e.displayName,returnAccountIdFunc=e=>e.accountId,IconOption=e=>r.createElement(l.c.Option,{...e},r.createElement("div",{ref:e.innerRef,...e.innerProps,className:"ac-flex"}," ",r.createElement("img",{src:e.data.iconUrl,width:"24",height:"24"})," ",r.createElement("span",{style:{marginLeft:"10px"}}," ",e.label," "))),SingleIconValue=e=>{let t="";return e.data.name&&(t=e.data.name),e.data.value&&(t=e.data.value),"string"===typeof e.data&&(t=e.data),r.createElement(l.c.SingleValue,{...e},r.createElement("div",{className:"ac-flex"},r.createElement("img",{src:e.data.iconUrl,width:"16",height:"16"}),r.createElement("span",{style:{marginLeft:"10px"}},t)))},MultiIconValue=e=>{let t="";return e.data.name&&(t=e.data.name),e.data.value&&(t=e.data.value),"string"===typeof e.data&&(t=e.data),r.createElement(l.c.MultiValueLabel,{...e},r.createElement("div",{className:"ac-flex"},r.createElement("img",{src:e.data.iconUrl,width:"16",height:"16"}),r.createElement("span",{style:{marginLeft:"10px"}},t)))},AvatarOption=e=>{const t=e.data.avatarUrls&&e.data.avatarUrls["48x48"]?e.data.avatarUrls["48x48"]:"";return r.createElement(l.c.Option,{...e},r.createElement("div",{ref:e.innerRef,...e.innerProps,className:"ac-flex"},r.createElement(n.A,{size:"small",borderColor:"var(--vscode-dropdown-backgrouns)!important",src:t}),r.createElement("span",{style:{marginLeft:"4px"}},e.label)))},SingleAvatarValue=e=>{let t="";e.data.name&&(t=e.data.name),e.data.displayName&&(t=e.data.displayName),"string"===typeof e.data&&(t=e.data);const a=e.data.avatarUrls&&e.data.avatarUrls["48x48"]?e.data.avatarUrls["48x48"]:"";return r.createElement(l.c.SingleValue,{...e},r.createElement("div",{ref:e.innerRef,...e.innerProps,className:"ac-flex"},r.createElement(n.A,{size:"small",borderColor:"var(--vscode-editor-background)!important",src:a}),r.createElement("span",{style:{marginLeft:"4px"}},t)))},MultiAvatarValue=e=>{let t="";e.data.name&&(t=e.data.name),e.data.displayName&&(t=e.data.displayName),"string"===typeof e.data&&(t=e.data);const a=e.data.avatarUrls&&e.data.avatarUrls["48x48"]?e.data.avatarUrls["48x48"]:"";return r.createElement(l.c.MultiValueLabel,{...e},r.createElement("div",{ref:e.innerRef,...e.innerProps,className:"ac-flex"},r.createElement(n.A,{size:"small",borderColor:"var(--vscode-editor-background)!important",src:a}),r.createElement("span",{style:{marginLeft:"4px"}},t)))},LabelOption=e=>{let t="";return"object"===typeof e.label?e.label.label?t=e.label.label:e.label.value&&(t=e.label.value):"string"===typeof e.label&&(t=e.label),r.createElement(l.c.Option,{...e},r.createElement("div",{ref:e.innerRef,...e.innerProps,dangerouslySetInnerHTML:{__html:t}}))},LabelValue=e=>{let t="";return"string"===typeof e.data&&(t=e.data),"object"===typeof e.data?e.data.name?t=e.data.name:e.data.displayName?t=e.data.displayName:e.data.label?t=e.data.label:e.data.value&&(t=e.data.value):t="string"===typeof e.data?e.data:"number"===typeof e.data?""+e.data:JSON.stringify(e.data),t=t.replace(/<b>/g,"").replace(/<\/b>/g,""),r.createElement(l.c.SingleValue,{...e},r.createElement("div",{ref:e.innerRef,...e.innerProps},t))},MultiLabelValue=e=>{let t="";return"object"===typeof e.data?e.data.name?t=e.data.name:e.data.displayName?t=e.data.displayName:e.data.label?t=e.data.label:e.data.value&&(t=e.data.value):t="string"===typeof e.data?e.data:"number"===typeof e.data?""+e.data:JSON.stringify(e.data),t=t.replace(/<b>/g,"").replace(/<\/b>/g,""),r.createElement(l.c.MultiValueLabel,{...e},r.createElement("div",{ref:e.innerRef,...e.innerProps},t))},StatusOption=e=>{const t=c.zK[e.data.to.statusCategory.colorName];return r.createElement(l.c.Option,{...e},r.createElement(s.A,{appearance:t},e.label))},StatusValue=e=>{const t=c.zK[e.data.to.statusCategory.colorName];return r.createElement(l.c.SingleValue,{...e},r.createElement(s.A,{appearance:t},e.data.to.name))},IssueLinkTypeOption=e=>r.createElement(l.c.Option,{...e},r.createElement("div",{ref:e.innerRef,...e.innerProps,className:"ac-flex"},r.createElement("span",{style:{marginLeft:"10px"}},e.label))),IssueLinkTypeValue=e=>r.createElement(l.c.SingleValue,{...e},r.createElement("div",{style:{display:"flex",alignItems:"center"}},r.createElement("span",{style:{marginLeft:"10px"}},e.data.name))),IssueSuggestionOption=e=>r.createElement(l.c.Option,{...e},r.createElement("div",{ref:e.innerRef,...e.innerProps,className:"ac-flex"},r.createElement("span",{style:{marginLeft:"10px"}},e.data.key),r.createElement("span",{style:{marginLeft:"1em"}},e.data.summaryText))),IssueSuggestionValue=e=>r.createElement(l.c.SingleValue,{...e},r.createElement("div",{ref:e.innerRef,...e.innerProps,className:"ac-flex"},r.createElement("span",{style:{marginLeft:"4px"}},e.data.key),r.createElement("span",{style:{marginLeft:"4px",marginRight:"4px"}},e.data.summaryText)));var o;function selectComponentType(e){return e.isCreateable&&""!==e.autoCompleteUrl.trim()?o.AsyncCreatable:e.isCreateable?o.Creatable:""!==e.autoCompleteUrl.trim()?o.Async:o.Select}function labelFuncForValueType(e){switch(e){case i.eV.Number:case i.eV.String:return returnOptionOrLabelFunc;case i.eV.IssueLinks:case i.eV.Component:case i.eV.Version:case i.eV.Project:case i.eV.IssueType:case i.eV.Transition:case i.eV.Priority:return returnNameFunc;case i.eV.Option:return returnValueFunc;case i.eV.User:case i.eV.Watches:return returnDisplayNameFunc;default:return returnOptionOrLabelFunc}}function valueFuncForValueType(e){switch(e){case i.eV.Number:case i.eV.String:return returnOptionOrValueFunc;case i.eV.Component:case i.eV.Version:case i.eV.Project:case i.eV.IssueType:case i.eV.Priority:case i.eV.Transition:case i.eV.Option:return returnIdFunc;case i.eV.IssueLinks:return returnNameFunc;case i.eV.Group:return returnValueOrNameFunc;case i.eV.User:case i.eV.Watches:return returnAccountIdFunc;default:return returnOptionOrValueFunc}}function getComponentsForValueType(e){return{Option:getOptionComponentForValueType(e),...getValueComponentForValueType(e)}}function getOptionComponentForValueType(e){switch(e){case i.eV.Priority:case i.eV.IssueType:return IconOption;case i.eV.Project:case i.eV.User:case i.eV.Watches:return AvatarOption;case i.eV.Transition:return StatusOption;case i.eV.IssueLinks:return IssueLinkTypeOption;default:return LabelOption}}function getValueComponentForValueType(e){switch(e){case i.eV.Priority:case i.eV.IssueType:return{SingleValue:SingleIconValue,MultiValueLabel:MultiIconValue};case i.eV.Project:case i.eV.User:case i.eV.Watches:return{SingleValue:SingleAvatarValue,MultiValueLabel:MultiAvatarValue};case i.eV.Transition:return{SingleValue:StatusValue};case i.eV.IssueLinks:return{SingleValue:IssueLinkTypeValue};default:return{SingleValue:LabelValue,MultiValueLabel:MultiLabelValue}}}!function(e){e.Select="select",e.Creatable="creatable",e.Async="async",e.AsyncCreatable="asynccreatable"}(o||(o={}))},64834:(e,t,a)=>{a.d(t,{t:()=>RenderedContent});var n=a(96540);const RenderedContent=e=>{const t=(0,n.useRef)(null);return(0,n.useEffect)((()=>{t.current&&e.fetchImage&&t.current.addEventListener("error",(async t=>{var a,n;if("IMG"===(null===(a=null===t||void 0===t?void 0:t.target)||void 0===a?void 0:a.nodeName)){const a=t.target,s=a.getAttribute("atlascode-original-src"),l=a.getAttribute("atlascode-original-src-handled");if(null!==s&&null===l){a.setAttribute("atlascode-original-src-handled","handled");const t=await(null===(n=e.fetchImage)||void 0===n?void 0:n.call(e,s));t&&t.length>0&&(a.src=`data:image/*;base64,${t}`,a.alt="",a.title="",a.setAttribute("width","auto"),a.setAttribute("height","auto"))}}}),{capture:!0})}),[e.fetchImage,t]),n.createElement("p",{ref:t,dangerouslySetInnerHTML:{__html:e.html}})}},70508:(e,t,a)=>{a.d(t,{A:()=>PopoutMentionPicker});var n=a(85832),s=a(22407),l=a(70246),i=a(3672),r=a(15547),c=a(96540);const UserOption=e=>c.createElement(l.c.Option,{...e},c.createElement("div",{ref:e.innerRef,style:{display:"flex",alignItems:"center"}},c.createElement(n.A,{size:"medium",borderColor:"var(--vscode-dropdown-foreground)!important",src:e.data.avatarUrl}),c.createElement(r.A,{content:e.data.mention},c.createElement("span",{style:{marginLeft:"4px"}},e.data.displayName))));class PopoutMentionPicker extends c.Component{constructor(e){super(e),this.toggleOpen=()=>{this.setState((e=>({isOpen:!e.isOpen})))},this.onSelectChange=e=>{this.setState({value:e,isOpen:!1}),this.props.onUserMentioned(e)},this.state={isOpen:!1,value:void 0}}render(){const{isOpen:e}=this.state;return c.createElement(Dropdown,{isOpen:e,onClose:this.toggleOpen,target:c.createElement(r.A,{content:this.props.targetButtonTooltip},c.createElement(s.A,{...this.props.targetButtonProps,onClick:this.toggleOpen},this.props.targetButtonContent))},c.createElement(i.A,{className:"ac-form-select-container",classNamePrefix:"ac-form-select",autoFocus:!0,backspaceRemovesValue:!1,components:{Option:UserOption,DropdownIndicator,IndicatorSeparator:null},menuIsOpen:!0,onChange:this.onSelectChange,loadOptions:this.props.loadUserOptions,placeholder:"Search...",tabSelectsValue:!1,controlShouldRenderValue:!1}))}}const Menu=e=>{const t="hsla(218, 50%, 10%, 0.1)";return c.createElement("div",{style:{backgroundColor:"white",borderRadius:4,boxShadow:`0 0 0 1px ${t}, 0 4px 11px ${t}`,marginTop:8,position:"absolute",zIndex:2,width:"350px"},...e})},Blanket=e=>c.createElement("div",{style:{bottom:0,left:0,top:0,right:0,position:"fixed",zIndex:1},...e}),Dropdown=({children:e,isOpen:t,target:a,onClose:n})=>c.createElement(c.Fragment,null,c.createElement("div",{style:{position:"relative"}},a,t?c.createElement(Menu,null,e):null,t?c.createElement(Blanket,{onClick:n}):null)),Svg=e=>c.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",focusable:"false",role:"presentation",...e}),DropdownIndicator=()=>c.createElement("div",{style:{color:"gray",height:24,width:32}},c.createElement(Svg,null,c.createElement("path",{d:"M16.436 15.085l3.94 4.01a1 1 0 0 1-1.425 1.402l-3.938-4.006a7.5 7.5 0 1 1 1.423-1.406zM10.5 16a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11z",fill:"currentColor",fillRule:"evenodd"})))},79841:(e,t,a)=>{a.d(t,{i:()=>AbstractIssueEditorPage,b:()=>H});var n=a(85832),s=a(7903),l=a(22407),i=a(39056),r=a(8367),c=a(44750),o=a(71778),d=a(98164),m=a(52556),u=a(45882),p=a(66278),h=a(2671),g=a(57617),y=a(3672),E=a(17565),f=a(75348),v=a(67459),b=a(72692),k=a(71210),C=a(55677),S=a(44414),V=a(20181),N=a.n(V),w=a(96540),P=a(76201),x=a(25279),I=a(6406),O=a(31074),A=a(27030),L=a(79402),F=a(59927),T=a(47292),M=a(17660),q=a(7135),R=a(86720),U=a(3519),$=a(64834),D=a(70508);const TextAreaEditor=({value:e,disabled:t,placeholder:a,fetchUsers:n,onChange:s})=>{const l=(0,w.useRef)(null),[i,r]=(0,w.useState)((null===e||void 0===e?void 0:e.length)||0);(0,w.useEffect)((()=>{l.current&&i>0&&(l.current.selectionEnd=i,l.current.selectionStart=i,l.current.focus())}),[l,i]);return w.createElement(w.Fragment,null,w.createElement("textarea",{className:"ac-textarea",rows:5,placeholder:a,value:e,onChange:e=>s(e.target.value),ref:l,disabled:t}),w.createElement("div",{className:"ac-textarea-toolbar"},w.createElement(D.A,{targetButtonContent:"@",targetButtonTooltip:"Mention @",loadUserOptions:n,onUserMentioned:e=>{if(!l.current)return;const{selectionStart:t,selectionEnd:a,value:n}=l.current,i=e.mention,c=`${n.slice(0,t)}${i} ${n.slice(a)}`;r(t+i.length),s(c)}})))},EditRenderedTextArea=({text:e,renderedText:t,fetchUsers:a,onSave:n,fetchImage:i})=>{const[r,c]=(0,w.useState)(!1),[o,d]=(0,w.useState)(e),[m,u]=(0,w.useState)(!1),handleSave=async()=>{try{u(!0),c(!1),await n(o)}finally{u(!1)}};return r?w.createElement(w.Fragment,null,w.createElement(U.A,{isSaving:m,content:w.createElement(TextAreaEditor,{value:o,fetchUsers:a,disabled:m,onChange:e=>d(e)})}),w.createElement(s.A,null,w.createElement(l.A,{className:"ac-button",onClick:handleSave,isDisabled:m},"Save"),w.createElement(l.A,{appearance:"default",onClick:()=>{c(!1),d(e)}},"Cancel"))):m?w.createElement(U.A,{content:w.createElement("p",{style:{whiteSpace:"pre-wrap",opacity:.5}},o)}):w.createElement(U.A,{content:w.createElement("div",{className:"ac-inline-input-view-p",onClick:()=>c(!0)},t?w.createElement($.t,{html:t,fetchImage:i}):w.createElement("p",null,e))})};class InlineIssueLinksEditor extends w.Component{constructor(e){super(e),this.handleOpenInlineEditor=e=>{this.setState({isEditing:!0,editorContainerClassname:"ac-flex-space-between"})},this.handleCancelInlineEdit=e=>{this.setState({isEditing:!1,editorContainerClassname:"ac-hidden"})},this.handleIssueLinkTypeChange=e=>{void 0!==this.state.selectedLinkType&&e.id===this.state.selectedLinkType.id||this.setState({selectedLinkType:e})},this.handleIssueChange=e=>{void 0!==this.state.selectedIssue&&e.key===this.state.selectedIssue.key||this.setState({selectedIssue:e})},this.handleCancel=()=>{this.setState({isEditing:!1,defaultIssueValue:void 0,selectedIssue:void 0,selectedLinkType:this.props.linkTypes.length>0?this.props.linkTypes[0]:void 0})},this.handleSave=e=>{this.setState({isEditing:!1,defaultIssueValue:void 0,selectedIssue:void 0,selectedLinkType:this.props.linkTypes.length>0?this.props.linkTypes[0]:void 0}),this.props.onSave({type:this.state.selectedLinkType,issueKey:this.state.selectedIssue.key})},this.state={linkTypes:e.linkTypes,label:e.label,isEditing:!1,isLoading:!1,isIssueLoading:!1,selectedIssue:void 0,editorContainerClassname:"ac-hidden",defaultIssueValue:void 0,selectedLinkType:e.linkTypes.length>0?e.linkTypes[0]:void 0}}componentWillReceiveProps(e){const t={};e.linkTypes&&e.linkTypes!==this.state.linkTypes&&(t.linkTypes=e.linkTypes),e.label&&e.label!==this.state.label&&(t.label=e.label),void 0!==e.isLoading&&e.isLoading!==this.state.isLoading&&(t.isLoading=e.isLoading),Object.keys(t).length>0&&this.setState(t)}render(){return w.createElement(w.Fragment,null,w.createElement("div",{className:"label-and-button"},w.createElement("label",{className:"ac-field-label",htmlFor:"issuelinks-editor"},this.props.label),w.createElement("button",{className:"ac-inline-add-button",onClick:this.handleOpenInlineEditor,disabled:this.state.isEditing||this.state.isLoading})),this.state.isLoading&&w.createElement(v.A,{size:"small"}),w.createElement("div",{className:this.state.editorContainerClassname},this.state.isEditing&&w.createElement(w.Fragment,null,w.createElement("div",{style:{width:"30%"}},w.createElement(g.A,{defaultValue:this.state.selectedLinkType,className:"ac-select-container",classNamePrefix:"ac-select",options:this.state.linkTypes,components:T.th(C.eV.IssueLinks),getOptionLabel:T.nM(C.eV.IssueLinks),getOptionValue:T.SY(C.eV.IssueLinks),isDisabled:this.state.isLoading,onChange:this.handleIssueLinkTypeChange})),w.createElement("div",{className:"ac-inline-edit-main_container-left-margin"},w.createElement("div",{style:{width:"100%"}},w.createElement(y.A,{defaultValue:this.state.defaultIssueValue,className:"ac-select-container",classNamePrefix:"ac-select",loadOptions:this.props.onFetchIssues,getOptionLabel:e=>e.key,getOptionValue:e=>e.key,placeholder:"Search for an issue",isLoading:this.state.isIssueLoading,isDisabled:this.state.isIssueLoading,onChange:this.handleIssueChange,components:{Option:T.BQ,SingleValue:T.HP}}))),w.createElement("div",{className:"ac-inline-edit-buttons-container"},w.createElement("button",{type:"button",className:"ac-inline-save-button",onClick:this.handleSave,disabled:void 0===this.state.selectedIssue}),w.createElement("button",{type:"button",className:"ac-inline-cancel-button",onClick:this.handleCancel})))))}}var B=a(70246),z=a(72007);const{Option:j}=B.c,IconOption=e=>w.createElement(j,{...e},w.createElement("div",{ref:e.innerRef,...e.innerProps,className:"ac-flex"},w.createElement("img",{src:e.data.iconUrl,width:"24",height:"24"}),w.createElement("span",{style:{marginLeft:"10px"}},e.label))),IconValue=e=>w.createElement(B.c.SingleValue,{...e},w.createElement("div",{style:{display:"flex",alignItems:"center"}},w.createElement("img",{src:e.data.iconUrl,width:"16",height:"16"}),w.createElement("span",{style:{marginLeft:"10px"}},e.data.name)));class InlineSubtaskEditor extends w.Component{constructor(e){super(e),this.handleOpenInlineEditor=e=>{this.setState({isEditing:!0,editorContainerClassname:"ac-flex-space-between"})},this.handleCancelInlineEdit=e=>{this.setState({isEditing:!1,editorContainerClassname:"ac-hidden"})},this.handleIssueTypeChange=e=>{e.id!==this.state.selectedIssueType.id&&this.setState({selectedIssueType:e})},this.handleSave=e=>{this.setState({inputValue:"",isEditing:!1,editorContainerClassname:"ac-hidden"}),this.props.onSave({summary:e,issuetype:{id:this.state.selectedIssueType.id}})},this.state={subtaskTypes:e.subtaskTypes,label:e.label,isEditing:!1,isLoading:!1,inputValue:"",editorContainerClassname:"ac-hidden",selectedIssueType:e.subtaskTypes.length>0?e.subtaskTypes[0]:z.hG}}componentWillReceiveProps(e){const t={};e.subtaskTypes&&e.subtaskTypes!==this.state.subtaskTypes&&(t.subtaskTypes=e.subtaskTypes),e.label&&e.label!==this.state.label&&(t.label=e.label),void 0!==e.isLoading&&e.isLoading!==this.state.isLoading&&(t.isLoading=e.isLoading),Object.keys(t).length>0&&this.setState(t)}render(){return w.createElement(w.Fragment,null,w.createElement("div",{className:"label-and-button"},w.createElement("label",{className:"ac-field-label",htmlFor:"subtasks-editor"},this.props.label),w.createElement("button",{className:"ac-inline-add-button",onClick:this.handleOpenInlineEditor,disabled:this.state.isEditing||this.state.isLoading})),this.state.isLoading&&w.createElement(v.A,{size:"small"}),w.createElement("div",{className:this.state.editorContainerClassname},this.state.isEditing&&w.createElement("div",{style:{width:"30%"}},w.createElement(g.A,{defaultValue:this.state.selectedIssueType,className:"ac-select-container",classNamePrefix:"ac-select",options:this.state.subtaskTypes,components:{Option:IconOption,SingleValue:IconValue},getOptionLabel:e=>e.name,getOptionValue:e=>e.id,isDisabled:this.state.isLoading,onChange:this.handleIssueTypeChange})),w.createElement(P.A,{type:"text",value:this.state.inputValue,onSave:this.handleSave,onCancel:this.handleCancelInlineEdit,validation:F.Qh,validationMessage:"sub-task summary is required",inputProps:{className:"ac-inputField",placeholder:"What needs to be done?",style:{width:"100%"}},mainContainerClassName:"ac-inline-edit-main_container-left-margin",editButtonClassName:"ac-hidden",cancelButtonClassName:"ac-inline-cancel-button",saveButtonClassName:"ac-inline-save-button",editing:this.state.isEditing})))}}class ParticipantList extends w.Component{constructor(e){super(e)}userList(){const e=[];return Array.isArray(this.props.users)&&this.props.users.forEach((t=>{if("string"===typeof t)e.push(w.createElement("div",null,t));else if(t.displayName){const a=t.avatarUrls&&t.avatarUrls["24x24"]?t.avatarUrls["24x24"]:"";e.push(w.createElement("div",{className:"ac-inline-watcher"},w.createElement(n.A,{size:"small",src:a}),w.createElement("div",{className:"ac-inline-watcher-name"},t.displayName)))}})),e}render(){return w.createElement(w.Fragment,null,this.userList())}}const H={type:"",siteDetails:I.Rc,fieldValues:{},selectFieldOptions:{},isSomethingLoading:!1,loadingField:"",editingField:"",isOnline:!0,showPMF:!1,isErrorBannerOpen:!1,errorDetails:void 0,commentInputValue:"",isRteEnabled:!1},shouldShowCreateOption=(e,t,a)=>0!==e.trim().length&&!a.find((t=>t.name===e));class AbstractIssueEditorPage extends M.B{constructor(){super(...arguments),this.handleInlineEdit=(e,t)=>Promise.resolve(),this.handleCreateComment=(e,t)=>{},this.handleSelectChange=N()(((e,t)=>{this.handleInlineEdit(e,this.formatEditValue(e,t))}),100),this.isClearableSelect=e=>!e.required||!!(e.isMulti&&this.state.fieldValues[e.key]&&this.state.fieldValues[e.key].length>0),this.handleExternalCommentSave=e=>{this.handleCreateComment(this.state.commentInputValue),this.setState({commentInputValue:""})},this.handleInternalCommentSave=e=>{this.handleCreateComment(this.state.commentInputValue,k.w9),this.setState({commentInputValue:""})},this.handleCommentCancelClick=e=>{this.setState({commentInputValue:""})},this.handleDismissError=()=>{this.setState({isErrorBannerOpen:!1,errorDetails:void 0})},this.handleOpenIssue=e=>{let t=e;"string"===typeof e&&(t={key:e,siteDetails:this.state.siteDetails});const a=(0,x.A)();this.postMessage({action:"openJiraIssue",issueOrKey:t,nonce:a})},this.handleInlineInputEdit=(e,t)=>{const a=t.target.value;this.handleInlineEdit(e,a)},this.handleCreateModeAttachments=(e,t)=>{t&&this.handleInlineEdit(t,e)},this.loadIssueOptions=(e,t)=>new Promise((a=>{const n=(0,x.A)();(async()=>{try{const s=await this.postMessageWithEventPromise({action:"fetchIssues",query:t,site:this.state.siteDetails,autocompleteUrl:e.autoCompleteUrl,nonce:n},"issueSuggestionsList",A.QJ,n);a(s.issues)}catch(e){a([])}})()})),this.loadSelectOptionsForField=(e,t)=>(this.setState({isSomethingLoading:!0,loadingField:e.key}),this.loadSelectOptions(t,this.fixAutocompleteUrl(e.autoCompleteUrl))),this.loadSelectOptions=(e,t)=>(this.setState({isSomethingLoading:!0}),new Promise((a=>{const n=(0,x.A)();(async()=>{try{const s=await this.postMessageWithEventPromise({action:"fetchSelectOptions",query:e,site:this.state.siteDetails,autocompleteUrl:t,nonce:n},"selectOptionsList",A.QJ,n);this.setState({isSomethingLoading:!1}),a(s.options)}catch(e){this.setState({isSomethingLoading:!1}),a([])}})()}))),this.handleSelectOptionCreate=N()(((e,t)=>{if(""!==e.createUrl.trim()){this.setState({isSomethingLoading:!0,loadingField:e.key});const a=(0,x.A)();(async()=>{try{const n=await this.postMessageWithEventPromise({action:"createOption",fieldKey:e.key,siteDetails:this.state.siteDetails,createUrl:e.createUrl,createData:{name:t,project:this.getProjectKey()},nonce:a},"optionCreated",A.QJ,a);this.setState({isSomethingLoading:!1,loadingField:"",fieldValues:{...this.state.fieldValues,...n.fieldValues},selectFieldOptions:{...this.state.selectFieldOptions,...n.selectFieldOptions}})}catch(e){this.setState({isSomethingLoading:!1})}})()}}),100)}formatEditValue(e,t){let a=t;if(void 0!==a&&null!==a)return e.valueType!==C.eV.String&&e.valueType!==C.eV.Number||"string"===typeof t||"number"===typeof t?e.valueType===C.eV.Group&&(a={name:t.value}):a=Array.isArray(t)?t.map((e=>"object"===typeof e?e.value:e)):t.value,a}onMessageReceived(e){let t=!1;switch(e.type){case"error":t=!0,(0,O.KR)(e)?this.setState({isSomethingLoading:!1,loadingField:"",isErrorBannerOpen:!0,errorDetails:e.reason,fieldValues:{...this.state.fieldValues,...e.fieldValues}}):this.setState({isSomethingLoading:!1,loadingField:"",isErrorBannerOpen:!0,errorDetails:e.reason});break;case"fieldValueUpdate":t=!0,this.setState({isSomethingLoading:!1,loadingField:"",fieldValues:{...this.state.fieldValues,...e.fieldValues}});break;case"pmfStatus":this.setState({showPMF:e.showPMF});break;case"updateFeatureFlags":this.setState({isRteEnabled:e.featureFlags.rteEnabled})}return t}postMessage(e){this._api.postMessage(e)}sortFieldValues(e){return Object.values(e).sort(((e,t)=>e.displayOrder<t.displayOrder?-1:e.displayOrder>t.displayOrder?1:0))}fixAutocompleteUrl(e){return e.includes("user/recommend")&&(e=e.replace("user/recommend","user/search")+"&query="),e}getInputMarkup(e,t=!1){switch(e.uiType){case C.HC.Input:{const a=this.getValidateFunction(e,t);let n="";const s=e.valueType,l=void 0===this.state.fieldValues[e.key]?"":this.state.fieldValues[e.key];switch(s){case C.eV.Number:n=`${e.name} must be a number`;break;case C.eV.Url:n=`${e.name} must be a URL`;break;default:e.required&&(n=`${e.name} is required`)}if(t){let t=w.createElement("p",null);return t=e.isMultiline?w.createElement(EditRenderedTextArea,{text:this.state.fieldValues[`${e.key}`],renderedText:this.state.fieldValues[`${e.key}.rendered`],fetchUsers:async e=>(await this.fetchUsers(e)).map((e=>{var t;return{displayName:e.displayName,avatarUrl:null===(t=e.avatarUrls)||void 0===t?void 0:t["48x48"],mention:this.state.siteDetails.isCloud?`[~accountid:${e.accountId}]`:`[~${e.name}]`}})),onSave:async t=>{await this.handleInlineEdit(e,t)},fetchImage:e=>this.fetchImage(e)}):w.createElement(P.A,{type:this.inlineEditTypeForValueType(e.valueType),value:l,onSave:t=>{this.handleInlineEdit(e,t)},validation:a,validationMessage:n,inputProps:{className:"ac-inputField"},viewProps:{id:e.key,className:"ac-inline-input-view-p"},editButtonClassName:"ac-hidden",cancelButtonClassName:"ac-inline-cancel-button",saveButtonClassName:"ac-inline-save-button",editOnViewClick:!0}),t}return w.createElement(o.A,{defaultValue:l,label:w.createElement("span",null,e.name),isRequired:e.required,id:e.key,name:e.key,validate:a},(t=>{let a=w.createElement("span",null);t.error&&""!==t.error&&(a=w.createElement(d.Kw,null,n));let s=w.createElement(b.A,{...t.fieldProps,className:"ac-inputField",isDisabled:this.state.isSomethingLoading,onChange:a=>(0,F.cy)(t.fieldProps.onChange,this.handleInlineEdit(e,a.currentTarget.value)),placeholder:"summary"===e.key&&"What needs to be done?"});return e.isMultiline&&(s=w.createElement(R.A,{...t.fieldProps,value:this.state.fieldValues[e.key],isDisabled:this.state.isSomethingLoading,onChange:a=>(0,F.cy)(t.fieldProps.onChange,this.handleInlineEdit(e,a)),fetchUsers:async e=>(await this.fetchUsers(e)).map((e=>{var t;return{displayName:e.displayName,avatarUrl:null===(t=e.avatarUrls)||void 0===t?void 0:t["48x48"],mention:this.state.siteDetails.isCloud?`[~accountid:${e.accountId}]`:`[~${e.name}]`}})),featureGateEnabled:this.state.isRteEnabled})),w.createElement("div",null,s,a)}))}case C.HC.Date:{let a=w.createElement("div",null);const n=this.getValidateFunction(e,t);return t?(a=w.createElement(r.A,{id:e.key,name:e.key,isLoading:this.state.loadingField===e.key,defaultValue:this.state.fieldValues[e.key],isDisabled:this.state.isSomethingLoading,className:"ac-select-container",selectProps:{className:"ac-select-container",classNamePrefix:"ac-select"},onChange:t=>{document.activeElement.blur(),this.handleInlineEdit(e,t)}}),a):w.createElement(o.A,{label:w.createElement("span",null,e.name),isRequired:e.required,id:e.key,name:e.key,validate:n},(t=>{let a=w.createElement("span",null);return"EMPTY"===t.error&&(a=w.createElement(d.Kw,null,e.name," is required")),w.createElement("div",null,w.createElement(r.A,{...t.fieldProps,isDisabled:this.state.isSomethingLoading,className:"ac-select-container",selectProps:{className:"ac-select-container",classNamePrefix:"ac-select"},onChange:F.cy(t.fieldProps.onChange,(t=>{this.handleInlineEdit(e,t)}))}),a)}))}case C.HC.DateTime:{let a=w.createElement("div",null);const n=this.getValidateFunction(e,t);return t?(a=w.createElement(c.A,{id:e.key,name:e.key,defaultValue:this.state.fieldValues[e.key],isDisabled:this.state.isSomethingLoading,className:"ac-select-container",datePickerSelectProps:{className:"ac-select-container",classNamePrefix:"ac-select"},timePickerSelectProps:{className:"ac-select-container",classNamePrefix:"ac-select"},onChange:t=>{document.activeElement.blur(),this.handleInlineEdit(e,t)}}),a):w.createElement(o.A,{label:w.createElement("span",null,e.name),isRequired:e.required,id:e.key,name:e.key,validate:n},(t=>{let a=w.createElement("span",null);return"EMPTY"===t.error&&(a=w.createElement(d.Kw,null,e.name," is required")),w.createElement("div",null,w.createElement(c.A,{...t.fieldProps,isDisabled:this.state.isSomethingLoading,className:"ac-select-container",datePickerSelectProps:{className:"ac-select-container",classNamePrefix:"ac-select"},timePickerSelectProps:{className:"ac-select-container",classNamePrefix:"ac-select"},onChange:F.cy(t.fieldProps.onChange,(t=>{this.handleInlineEdit(e,t)}))}),a)}))}case C.HC.Subtasks:{let a=w.createElement(w.Fragment,null);return t&&(a=w.createElement(InlineSubtaskEditor,{label:e.name,subtaskTypes:this.state.selectFieldOptions[e.key],onSave:t=>{this.handleInlineEdit(e,t)},isLoading:this.state.loadingField===e.key})),a}case C.HC.IssueLinks:{let a=w.createElement("div",null);if(!t){const t=e.required?F.NJ:void 0;return w.createElement(w.Fragment,null,w.createElement(o.A,{label:w.createElement("span",null,e.name),isRequired:e.required,id:`${e.key}.type`,name:`${e.key}.type`,validate:t},(t=>{let a=w.createElement("span",null);return"EMPTY"===t.error&&(a=w.createElement(d.Kw,null,e.name," is required")),w.createElement("div",null,w.createElement(g.A,{...t.fieldProps,isMulti:!1,isClearable:!e.required,className:"ac-form-select-container",classNamePrefix:"ac-form-select",components:T.th(C.eV.IssueLinks),getOptionLabel:T.nM(C.eV.IssueLinks),getOptionValue:T.SY(C.eV.IssueLinks),placeholder:"Select link type",isDisabled:this.state.isSomethingLoading,options:this.state.selectFieldOptions[e.key],onChange:F.cy(t.fieldProps.onChange,(t=>{const a={...e,key:`${e.key}.type`};this.handleInlineEdit(a,t)}))}),a)})),w.createElement(o.A,{id:`${e.key}.issue`,name:`${e.key}.issue`},(t=>w.createElement(y.A,{...t.fieldProps,isClearable:!0,isMulti:!0,className:"ac-form-select-container",classNamePrefix:"ac-form-select",loadOptions:async t=>await this.loadIssueOptions(e,t),getOptionLabel:e=>e.key,getOptionValue:e=>e.key,placeholder:"Search for an issue",isLoading:this.state.loadingField===e.key,isDisabled:this.state.isSomethingLoading,onChange:F.cy(t.fieldProps.onChange,(t=>{const a={...e,key:`${e.key}.issue`};this.handleInlineEdit(a,t)})),components:{Option:T.BQ,SingleValue:T.HP}}))))}return a=w.createElement(InlineIssueLinksEditor,{label:e.name,linkTypes:this.state.selectFieldOptions[e.key],onSave:t=>{this.handleInlineEdit(e,t)},isLoading:this.state.loadingField===e.key,onFetchIssues:async t=>await this.loadIssueOptions(e,t)}),a}case C.HC.Comments:{const t=this.state.fieldValues.project&&"service_desk"===this.state.fieldValues.project.projectTypeKey;return w.createElement("div",{style:{width:"100%",padding:"10px",boxSizing:"border-box"}},this.state.loadingField===e.key&&w.createElement(v.A,{size:"large"}),w.createElement(TextAreaEditor,{value:this.state.commentInputValue,fetchUsers:async e=>(await this.fetchUsers(e)).map((e=>{var t;return{displayName:e.displayName,avatarUrl:null===(t=e.avatarUrls)||void 0===t?void 0:t["48x48"],mention:this.state.siteDetails.isCloud?`[~accountid:${e.accountId}]`:`[~${e.name}]`}})),placeholder:"Add a comment...",disabled:!1,onChange:e=>this.setState({commentInputValue:e})}),w.createElement(s.A,null,w.createElement(l.A,{className:"ac-button",onClick:this.handleExternalCommentSave,isDisabled:""===this.state.commentInputValue||this.state.isSomethingLoading},t?"Reply to customer":"Save"),t&&w.createElement(l.A,{className:"ac-button",onClick:this.handleInternalCommentSave,isDisabled:""===this.state.commentInputValue||this.state.isSomethingLoading},"Add internal note"),w.createElement(l.A,{appearance:"default",onClick:this.handleCommentCancelClick},"Cancel")))}case C.HC.Select:{const a=e;let n;e.required&&(n=a.isMulti?F.Ef:F.NJ);let s=this.state.fieldValues[e.key];"string"!==typeof this.state.fieldValues[e.key]&&"number"!==typeof this.state.fieldValues[e.key]||(s={label:""+s,value:""+s});const l={isMulti:a.isMulti,getOptionLabel:T.nM(a.valueType),getOptionValue:T.SY(a.valueType),components:T.th(a.valueType)};switch(t&&(l.label=e.name,l.id=e.key,l.name=e.key,l.value=s),T.iS(a)){case T.ye.Select:return t?w.createElement(g.A,{...l,className:"ac-select-container",classNamePrefix:"ac-select",isClearable:this.isClearableSelect(a),options:this.state.selectFieldOptions[e.key],isDisabled:this.state.isSomethingLoading,onChange:e=>{this.handleSelectChange(a,e)}}):w.createElement(o.A,{label:w.createElement("span",null,e.name),isRequired:e.required,id:e.key,name:e.key,validate:n,defaultValue:s},(t=>{let n=w.createElement("span",null);return"EMPTY"===t.error&&(n=w.createElement(d.Kw,null,e.name," is required")),w.createElement(w.Fragment,null,w.createElement(g.A,{...t.fieldProps,...l,className:"ac-form-select-container",classNamePrefix:"ac-form-select",isClearable:this.isClearableSelect(a),options:this.state.selectFieldOptions[e.key],isDisabled:this.state.isSomethingLoading,onChange:F.cy(t.fieldProps.onChange,(e=>{this.handleSelectChange(a,e)}))}),n)}));case T.ye.Creatable:return t?w.createElement(E.A,{...l,className:"ac-select-container",classNamePrefix:"ac-select",placeholder:"Type to create new option",createOptionPosition:"first",value:this.state.fieldValues[e.key],isClearable:this.isClearableSelect(a),options:this.state.selectFieldOptions[e.key],isDisabled:this.state.isSomethingLoading,isLoading:this.state.loadingField===e.key,isValidNewOption:shouldShowCreateOption,noOptionsMessage:e=>"Type to create new option",onCreateOption:e=>{this.handleSelectOptionCreate(a,e)},onChange:e=>{this.handleSelectChange(a,e)}}):w.createElement(o.A,{label:w.createElement("span",null,e.name),isRequired:e.required,id:e.key,name:e.key,validate:n,defaultValue:s},(t=>{let n=w.createElement("span",null);return"EMPTY"===t.error&&(n=w.createElement(d.Kw,null,e.name," is required")),w.createElement(w.Fragment,null,w.createElement(E.A,{...t.fieldProps,...l,className:"ac-form-select-container",classNamePrefix:"ac-form-select",placeholder:"Type to create new option",createOptionPosition:"first",noOptionsMessage:e=>"Type to create new option",isClearable:this.isClearableSelect(a),options:this.state.selectFieldOptions[e.key],isDisabled:this.state.isSomethingLoading,isLoading:this.state.loadingField===e.key,isValidNewOption:shouldShowCreateOption,onCreateOption:e=>{this.handleSelectOptionCreate(a,e)},onChange:F.cy(t.fieldProps.onChange,(e=>{this.handleSelectChange(a,e)}))}),n)}));case T.ye.Async:return t?w.createElement(y.A,{...l,placeholder:"Type to search",className:"ac-select-container",classNamePrefix:"ac-select",noOptionsMessage:e=>"Type to search",isClearable:this.isClearableSelect(a),isDisabled:this.state.isSomethingLoading&&this.state.loadingField!==e.key,defaultOptions:this.state.selectFieldOptions[e.key],isLoading:this.state.loadingField===e.key,onChange:e=>{this.handleSelectChange(a,e)},loadOptions:async t=>await this.loadSelectOptionsForField(e,t)}):w.createElement(o.A,{label:w.createElement("span",null,e.name),isRequired:e.required,id:e.key,name:e.key,validate:n,defaultValue:s},(t=>{let n=w.createElement("span",null);return"EMPTY"===t.error&&(n=w.createElement(d.Kw,null,e.name," is required")),w.createElement(w.Fragment,null,w.createElement(y.A,{...t.fieldProps,...l,className:"ac-form-select-container",classNamePrefix:"ac-form-select",placeholder:"Type to search",noOptionsMessage:e=>"Type to search",isDisabled:this.state.isSomethingLoading&&this.state.loadingField!==e.key,isClearable:this.isClearableSelect(a),defaultOptions:this.state.selectFieldOptions[e.key],isLoading:this.state.loadingField===e.key,onChange:F.cy(t.fieldProps.onChange,(e=>{this.handleSelectChange(a,e)})),loadOptions:async t=>await this.loadSelectOptionsForField(e,t)}),n)}));case T.ye.AsyncCreatable:{let i,r;return""!==a.createUrl.trim()?i=e=>{this.handleSelectOptionCreate(a,e)}:r=(e,t)=>({label:e,value:e}),t?w.createElement(f.A,{...l,className:"ac-select-container",classNamePrefix:"ac-select",placeholder:"Type to search",createOptionPosition:"first",value:this.state.fieldValues[e.key],noOptionsMessage:e=>"Type to search",isDisabled:this.state.isSomethingLoading&&this.state.loadingField!==e.key,isClearable:this.isClearableSelect(a),defaultOptions:this.state.selectFieldOptions[e.key],isLoading:this.state.loadingField===e.key,isValidNewOption:shouldShowCreateOption,onCreateOption:i,getNewOptionData:r,onChange:e=>{this.handleSelectChange(a,e)},loadOptions:async t=>await this.loadSelectOptionsForField(e,t)}):w.createElement(o.A,{label:w.createElement("span",null,e.name),isRequired:e.required,id:e.key,name:e.key,validate:n,defaultValue:s},(t=>{let n=w.createElement("span",null);return"EMPTY"===t.error&&(n=w.createElement(d.Kw,null,e.name," is required")),w.createElement(w.Fragment,null,w.createElement(f.A,{...t.fieldProps,...l,className:"ac-form-select-container",classNamePrefix:"ac-form-select",placeholder:"Type to search",createOptionPosition:"first",noOptionsMessage:e=>"Type to search",isDisabled:this.state.isSomethingLoading&&this.state.loadingField!==e.key,isClearable:this.isClearableSelect(a),defaultOptions:this.state.selectFieldOptions[e.key],isLoading:this.state.loadingField===e.key,isValidNewOption:shouldShowCreateOption,onCreateOption:i,getNewOptionData:r,onChange:F.cy(t.fieldProps.onChange,(e=>{this.handleSelectChange(a,e)})),loadOptions:async t=>await this.loadSelectOptionsForField(e,t)}),n)}))}}}case C.HC.Checkbox:{if(t){const t=e,a={isMulti:!0,className:"ac-select-container",classNamePrefix:"ac-select",getOptionLabel:T.nM(e.valueType),getOptionValue:T.SY(e.valueType),components:T.th(e.valueType),label:e.name,id:e.key,name:e.key,defaultValue:this.state.fieldValues[e.key],isClearable:!0};return w.createElement(g.A,{...a,isClearable:!0,options:t.allowedValues,isDisabled:this.state.isSomethingLoading,onChange:e=>{this.handleSelectChange(t,e)}})}const a=w.createElement("span",{style:{color:"var(--vscode-editor-foreground)!important"}},e.name),n=[];return e.allowedValues.forEach((t=>{n.push(w.createElement(m.A,{name:e.key,id:e.key,value:t.id,isRequired:e.required},(a=>w.createElement(i.A,{...a.fieldProps,onChange:F.cy(a.fieldProps.onChange,(t=>{this.handleInlineEdit(e,t.target.checked)})),label:t.value}))))})),w.createElement(u.A,{legend:a},n)}case C.HC.Radio:{if(t){const t=e,a={isMulti:!1,className:"ac-select-container",classNamePrefix:"ac-select",getOptionLabel:T.nM(e.valueType),getOptionValue:T.SY(e.valueType),components:T.th(e.valueType),label:e.name,id:e.key,name:e.key,defaultValue:this.state.fieldValues[e.key],isClearable:!e.required};return w.createElement(g.A,{...a,isClearable:!0,options:t.allowedValues,isDisabled:this.state.isSomethingLoading,onChange:e=>{this.handleSelectChange(t,e)}})}const a=[];e.allowedValues.forEach((t=>{a.push({name:e.key,label:t.value,value:t.id})}));const n=e.required?F.Ef:void 0;return w.createElement(o.A,{label:w.createElement("span",null,e.name),isRequired:e.required,id:e.key,name:e.key,validate:n},(t=>w.createElement(h.A,{...t.fieldProps,onChange:F.cy(t.fieldProps.onChange,(t=>{this.handleInlineEdit(e,t)})),options:a})))}case C.HC.Timetracking:{const a=this.getValidateFunction(e,t);if(t){const t=this.state.fieldValues[e.key]&&this.state.fieldValues[e.key].originalEstimate&&""!==this.state.fieldValues[e.key].originalEstimate.trim();return w.createElement("div",null,w.createElement(P.A,{type:"text",value:t?this.state.fieldValues[e.key].originalEstimate:"0m",onSave:t=>{this.handleInlineEdit(e,t)},inputProps:{className:"ac-inputField"},viewProps:{id:e.key,className:"ac-inline-input-view-p"},editButtonClassName:"ac-hidden",cancelButtonClassName:"ac-inline-cancel-button",saveButtonClassName:"ac-inline-save-button",editOnViewClick:!0}),w.createElement(d.st,null,"(eg. 3w 4d 12h)"))}return w.createElement("div",{className:"ac-flex"},w.createElement(o.A,{label:"Original estimate",isRequired:e.required,id:`${e.key}.originalEstimate`,name:`${e.key}.originalEstimate`,validate:a},(t=>{let a=w.createElement("span",null);return"EMPTY"===t.error&&(a=w.createElement(d.Kw,null,e.name," is required")),w.createElement("div",null,w.createElement("input",{...t.fieldProps,onChange:F.cy(t.fieldProps.onChange,(t=>{const a={...e,key:`${e.key}.originalEstimate`};this.handleInlineInputEdit(a,t)})),className:"ac-inputField"}),w.createElement(d.st,null,"(eg. 3w 4d 12h)"),a)})),w.createElement("div",{className:"ac-inline-flex-hpad"}),w.createElement(o.A,{label:"Remaining estimate",isRequired:e.required,id:`${e.key}.remainingEstimate`,name:`${e.key}.remainingEstimate`,validate:a},(t=>{let a=w.createElement("span",null);return"EMPTY"===t.error&&(a=w.createElement(d.Kw,null,e.name," is required")),w.createElement("div",null,w.createElement("input",{...t.fieldProps,onChange:F.cy(t.fieldProps.onChange,(t=>{const a={...e,key:`${e.key}.remainingEstimate`};this.handleInlineInputEdit(a,t)})),className:"ac-inputField"}),w.createElement(d.st,null,"(eg. 3w 4d 12h)"),a)})))}case C.HC.Worklog:{if(t)return w.createElement("div",null,"don't call getInputMarkup for worklog in editmode");const a=F.oI;return w.createElement(w.Fragment,null,w.createElement("div",{style:{display:e.required?"none":"block"}},w.createElement(o.A,{id:`${e.key}.enabled`,name:`${e.key}.enabled`},(t=>w.createElement(i.A,{...t.fieldProps,onChange:F.cy(t.fieldProps.onChange,(t=>{const a={...e,key:`${e.key}.enabled`};this.handleInlineEdit(a,t.target.checked)})),label:"Log work"})))),this.state.fieldValues[e.key]&&this.state.fieldValues[e.key].enabled&&w.createElement(w.Fragment,null,w.createElement("div",{className:"ac-flex"},w.createElement(o.A,{label:"Worklog time spent",isRequired:!0,id:`${e.key}.timeSpent`,name:`${e.key}.timeSpent`,validate:a},(t=>{let a=w.createElement("span",null);return"EMPTY"===t.error&&(a=w.createElement(d.Kw,null,"Time spent is required")),w.createElement("div",null,w.createElement("input",{...t.fieldProps,onChange:F.cy(t.fieldProps.onChange,(t=>{const a={...e,key:`${e.key}.timeSpent`};this.handleInlineInputEdit(a,t)})),className:"ac-inputField"}),w.createElement(d.st,null,"(eg. 3w 4d 12h)"),a)})),w.createElement("div",{className:"ac-inline-flex-hpad"}),w.createElement(o.A,{label:"Remaining estimate",isRequired:!0,id:`${e.key}.newEstimate`,name:`${e.key}.newEstimate`,validate:a},(t=>{let a=w.createElement("span",null);return"EMPTY"===t.error&&(a=w.createElement(d.Kw,null,"Remaining estimate is required")),w.createElement("div",null,w.createElement("input",{...t.fieldProps,onChange:F.cy(t.fieldProps.onChange,(t=>{const a={...e,key:`${e.key}.newEstimate`};this.handleInlineInputEdit(a,t)})),className:"ac-inputField"}),w.createElement(d.st,null,"(eg. 3w 4d 12h)"),a)}))),w.createElement(o.A,{label:"Worklog start time",isRequired:!0,id:`${e.key}.started`,name:`${e.key}.started`,validate:a},(t=>{let a=w.createElement("span",null);return"EMPTY"===t.error&&(a=w.createElement(d.Kw,null,"Start time is required")),w.createElement("div",null,w.createElement(c.A,{...t.fieldProps,className:"ac-select-container",timeIsEditable:!0,datePickerSelectProps:{className:"ac-select-container",classNamePrefix:"ac-select"},timePickerSelectProps:{className:"ac-select-container",classNamePrefix:"ac-select"},onChange:F.cy(t.fieldProps.onChange,(t=>{const a={...e,key:`${e.key}.started`};this.handleInlineEdit(a,t)}))}),a)})),w.createElement(o.A,{label:"Worklog comment",isRequired:!1,id:`${e.key}.comment`,name:`${e.key}.comment`},(t=>w.createElement("textarea",{...t.fieldProps,style:{width:"100%",display:"block"},className:"ac-textarea",rows:5,onChange:F.cy(t.fieldProps.onChange,(t=>{const a={...e,key:`${e.key}.comment`};this.handleInlineInputEdit(a,t)}))})))))}case C.HC.Participants:return w.createElement(ParticipantList,{users:this.state.fieldValues[e.key]});case C.HC.NonEditable:return this.getNonEditableMarkup(e.valueType,this.state.fieldValues[e.key]);case C.HC.Attachment:return t?w.createElement("div",null):w.createElement("div",{className:"ac-vpadding"},w.createElement("label",{className:"ac-field-label"},e.name),w.createElement(q.S,{isInline:!0,field:e,onFilesChanged:this.handleCreateModeAttachments}))}const a=e.required?F.oI:void 0;return t?w.createElement("div",{style:{color:"red"}},"Unknown field type - ",e.key," : ",e.uiType):w.createElement(o.A,{label:w.createElement("span",null,e.name),isRequired:e.required,id:e.key,name:e.key,validate:a},(t=>{let a=w.createElement("span",null);return"EMPTY"===t.error&&(a=w.createElement(d.Kw,null,e.name," is required")),w.createElement("div",null,w.createElement("div",{style:{color:"red"}},"Unknown field type - ",e.key," : ",e.uiType),w.createElement("input",{...t.fieldProps,style:{width:"100%",display:"block"},className:"ac-inputField"}),a)}))}getNonEditableMarkup(e,t){switch(e){case C.eV.Url:case C.eV.Number:case C.eV.String:return w.createElement("div",{className:"ac-vpadding"},w.createElement("div",{className:"ac-"},t));case C.eV.DateTime:case C.eV.Date:return w.createElement("div",{className:"ac-vpadding"},w.createElement("div",null,"$",(0,S.m)(t)," ago`"));case C.eV.Option:return w.createElement("div",{className:"ac-vpadding"},w.createElement("div",null,t.value));case C.eV.IssueType:case C.eV.Priority:return w.createElement("div",{className:"ac-vpadding"},w.createElement("div",{className:"ac-flex"},w.createElement("img",{src:t.iconUrl,width:"24",height:"24",alt:t.name||"Icon"}),w.createElement("span",{style:{marginLeft:"10px"}},t.name)));case C.eV.Status:{const e=L.zK[t.statusCategory.colorName];return w.createElement("div",{className:"ac-vpadding"},w.createElement(p.A,{appearance:e},t.name))}case C.eV.Transition:{const e=L.zK[t.to.statusCategory.colorName];return w.createElement("div",{className:"ac-vpadding"},w.createElement(p.A,{appearance:e},t.name))}case C.eV.User:case C.eV.Project:{const e=t.displayName?t.displayName:t.name,a=t.avatarUrls&&t.avatarUrls["24x24"]?t.avatarUrls["24x24"]:"";return w.createElement("div",{className:"ac-vpadding"},w.createElement("div",{className:"ac-flex"},w.createElement(n.A,{size:"medium",borderColor:"var(--vscode-dropdown-foreground)!important",src:a}),w.createElement("span",{style:{marginLeft:"4px"}},e)))}case C.eV.Attachment:case C.eV.Worklog:case C.eV.IssueLinks:case C.eV.CommentsPage:case C.eV.Timetracking:return w.createElement(w.Fragment,null);case C.eV.Group:case C.eV.Component:case C.eV.Version:if(Array.isArray(t)){const e=t.map((e=>e.name));return w.createElement("div",{className:"ac-vpadding"},w.createElement("div",null,e))}return w.createElement("div",{className:"ac-vpadding"},w.createElement("div",null,t.name))}return"object"===typeof t&&(t=JSON.stringify(t)),w.createElement("div",null,t)}getValidateFunction(e,t=!1){let a;switch(e.valueType){case C.eV.Number:a=t?e.required?F.Ve:F.gf:e.required?F.RD:F.yb;break;case C.eV.Url:a=t?e.required?F.xC:F.AY:e.required?F.JR:F.wv;break;default:e.required&&(a=t?F.Qh:F.oI)}return a}inlineEditTypeForValueType(e){switch(e){case C.eV.Url:return"url";case C.eV.Number:return"number";default:return"text"}}}},86720:(e,t,a)=>{a.d(t,{A:()=>JiraIssueTextArea});var n=a(39939),s=a(21430),l=a(15547),i=a(59972),r=a(96540),c=a(2543),o=a(46762),d=a(73337),m=a(92320),u=a(89552),p=a(89781),h=a(38341),g=a(61396),y=a(87155),E=a(39082),f=a(69025),v=a(58903),b=a(42845),k=a(1575);function markInputRule(e,t,a){return new h.fV(e,((e,n,s,l)=>{const i=a instanceof Function?a(n):a,r=e.tr,c=n[0],o=n.length>2?n[1]:"",d=n.length>2?n[2]:n[1];if(d){const e=s+c.indexOf(d),t=e+d.length;t<l&&r.delete(t,l),e>s&&r.delete(s+o.length,e),l=s+o.length+d.length}return r.addMark(s+o.length,l,t.create(i)),r.removeStoredMark(t),r}))}const buildInputRules=e=>{const t=[];return e.marks.strong&&t.push(markInputRule(/(?:\*)([^\*_]+)(?:\*)$/,e.marks.strong,void 0)),e.marks.em&&t.push(markInputRule(/(^|[^_])(?:_)([^_]+)(?:_)$/,e.marks.em,void 0)),e.marks.code&&t.push(markInputRule(/(^|[^`])(?:`)([^`]+)(?:`)$/,e.marks.code,void 0)),e.marks.link&&t.push(markInputRule(/(^|[^!])\[(.*?)\]\((\S+)\)$/,e.marks.link,(e=>({href:e[3]})))),t.push((0,h.tG)(/^\s*>\s$/,e.nodes.blockquote),(0,h.tG)(/^(\d+)\.\s$/,e.nodes.ordered_list,(e=>({order:+e[1]})),((e,t)=>t.childCount+t.attrs.order===+e[1])),(0,h.tG)(/^\s*([-+*])\s$/,e.nodes.bullet_list),(0,h.JJ)(/^```$/,e.nodes.code_block),(0,h.JJ)(new RegExp("^(#{1,6})\\s$"),e.nodes.heading,(e=>({level:e[1].length})))),t},C=new v.Sj({nodes:(0,E.hF)(y.wQ.spec.nodes),marks:y.wQ.spec.marks});const S=new y.K6({...y.lR.nodes,mention:(e,t)=>{e.write(t.attrs.id)},text:(e,t)=>{const a=function findAllMentions(e){return e.match(/\[~[a-zA-Z0-9:-]+\]/g)}(t.text);let n=t.text;if(a&&a.length>0)for(const t of a){const a=n.indexOf(t),s=n.slice(0,a),l=n.slice(a+t.length);e.text(s,!e.isAutolink),e.write(t),n=l}e.text(n,!e.isAutolink)}},{...y.lR.marks,em:{open:"_",close:"_",mixable:!0,expelEnclosingWhitespace:!0},strong:{open:"*",close:"*",mixable:!0,expelEnclosingWhitespace:!0}}),V=new y.Fd(C,y.ee.tokenizer,{...y.ee.tokens,mention:{node:"mention"}}),N=new b.hs("reactProps");var w=a(70508);const JiraIssueTextArea=({value:e,onChange:t,onEditorFocus:a,onCancel:y,onSave:v,fetchUsers:P,isServiceDeskProject:x,onInternalCommentSave:I,isDescription:O,saving:A,featureGateEnabled:L=!1})=>{const F=r.useRef(null),[T,M]=r.useState((null===e||void 0===e?void 0:e.length)||0),[q,R]=r.useState(L),{viewHost:U,handleSave:$}=function useEditor(e){const t=(0,r.useRef)(null),a=(0,r.useRef)(null),[n,s]=(0,r.useState)(e.value||""),l=e.fetchUsers&&(0,c.debounce)(e.fetchUsers,1500,{leading:!0,maxWait:1}),i=(0,r.useCallback)((()=>{if(!e.onSave||!a.current)return;const t=e.enabled?S.serialize(a.current.state.doc):n;t.trim().length>0&&e.onSave(t)}),[e,n,a]);return(0,r.useEffect)((()=>{if(a.current)if(e.enabled){const e=a.current.state.doc.slice(0),t=a.current.state.tr.replaceWith(0,(null===e||void 0===e?void 0:e.size)||0,V.parse(n));a.current.dispatch(t)}else s(S.serialize(a.current.state.doc))}),[e.enabled]),(0,r.useEffect)((()=>{const i=(0,m.Kw)(C),c=[(y=e,new b.k_({key:N,state:{init:()=>y,apply:(e,t)=>e.getMeta(N)||t}})),(0,g.w)((0,m.eu)(C)),(0,g.w)(o.RV),(0,d.A)(),(0,u.z)(),(0,f.Hy)({floating:!1,content:[[i.toggleStrong,i.toggleEm,i.toggleCode],[i.wrapBulletList,i.wrapOrderedList,i.wrapBlockQuote,f.rm]]}),(0,p.b6)(),(0,h.sM)({rules:buildInputRules(C)})];var y;l&&c.unshift((0,E.Z7)({getSuggestions:async(e,t,a)=>{if("mention"===e){const e=await l(t);a(e?e.map((e=>({name:e.displayName,id:e.mention,avatarUrl:e.avatarUrl||"",email:e.emailAddress||""}))):[])}},getSuggestionsHTML:(e,t)=>"mention"===t?(e=>'<div class="suggestion-item-list">'+e.map((e=>`<div class="suggestion-item">${e.name}</div>`)).join("")+"</div>")(e):r.createElement(r.Fragment,null)}));const v=b.$t.create({schema:C,doc:V.parse(n),plugins:c}),w=new k.Lz(t.current,{state:v,dispatchTransaction(t){const a=w.state.apply(t);if(w.updateState(a),t.docChanged){const t=e.enabled?S.serialize(a.doc):n;s(t),e.onChange(t)}}});return a.current=w,()=>w.destroy()}),[]),(0,r.useEffect)((()=>{if(a.current){const t=a.current.state.tr.setMeta(N,e);a.current.dispatch(t)}})),{viewHost:t,handleSave:i}}({value:e,onSave:e=>{t(e),null===v||void 0===v||v(e)},onChange:t,enabled:q,fetchUsers:P});r.useEffect((()=>{F.current&&T>0&&(F.current.selectionEnd=T,F.current.selectionStart=T,F.current.focus())}),[F,T]);const D=r.useCallback((e=>{if(!F.current)return;const{selectionStart:a,selectionEnd:n,value:s}=F.current,l=e.mention,i=`${s.slice(0,a)}${l} ${s.slice(n)}`;M(a+l.length),t(i)}),[t]);return r.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},r.createElement("div",{role:"textbox",hidden:!q,ref:U,"aria-label":"Jira rich text editor"}),r.createElement("div",{hidden:q},r.createElement(n.A,{style:{background:"var(--vscode-input-background)",color:"var(--vscode-input-foreground)",border:"1px solid var(--vscode-input-border)",caretColor:"var(--vscode-editorCursor-background)",minHeight:O?"175px":"100px",borderRadius:"2px",overflow:"auto"},value:e,ref:F,autoFocus:!0,onFocus:a||void 0,onChange:e=>t(e.target.value),isDisabled:A})),r.createElement("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"8px"}},r.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"8px"}},v&&r.createElement(i.Ls,{appearance:"primary",onClick:()=>{q?$():v(e)},disabled:A},x?"Reply":"Save"),x&&I&&r.createElement(i.Ls,{appearance:"secondary",onClick:I,disabled:A},"Add internal note"),y&&r.createElement(i.Ls,{appearance:"secondary",onClick:y,disabled:A},"Cancel"),P&&!q&&r.createElement(w.A,{targetButtonContent:"@",targetButtonTooltip:"Mention @",targetButtonProps:{spacing:"compact",appearance:"subtle"},loadUserOptions:P,onUserMentioned:D})),L&&r.createElement(l.A,{content:"Toggle rich text editor",position:"top"},r.createElement(s.A,{label:"rte toggle",defaultChecked:!0,onChange:e=>R(e.target.checked)}))))}},97503:(e,t,a)=>{a.d(t,{A:()=>PMFBBanner});var n=a(7903),s=a(22407),l=a(32456),i=a(71778),r=a(6994),c=a(94969),o=a(22648),d=a(2671),m=a(15560),u=a(96540),p=a(59927);const h="How would you feel if you could no longer use this extension?",g="(optional) How can we improve this extension for you?",y="(optional) What would you use as an alternative if this extension were no longer available?",E="(optional) What is the main benefit you receive from this extension?";class PMFBBanner extends u.Component{constructor(e){super(e),this.handleOpen=()=>{this.props.onPMFOpen(),this.setState({isOpen:!0})},this.handleLater=()=>{this.props.onPMFLater(),this.props.onPMFVisiblity(!1),this.setState({isOpen:!1})},this.handleNever=()=>{this.props.onPMFNever(),this.props.onPMFVisiblity(!1),this.setState({isOpen:!1})},this.handleFeedback=e=>{this.props.onPMFSubmit(e),this.props.onPMFVisiblity(!1),this.setState({isOpen:!1})},this.updateQ1=e=>(this.setState({q1Value:e}),e),this.state={isOpen:!1,q1Value:void 0}}render(){const{isOpen:e}=this.state,t=[{name:"0",label:"Very disappointed",value:"0"},{name:"1",label:"Somewhat disappointed",value:"1"},{name:"2",label:"Not disappointed",value:"2"}];return u.createElement("div",null,u.createElement(m.A,{appearance:"change",title:"Take a quick survey to let us know how we're doing"},u.createElement("div",null,u.createElement(n.A,null,u.createElement(s.A,{className:"ac-button",onClick:this.handleOpen},"Take Survey"),u.createElement(s.A,{className:"ac-banner-link-button",appearance:"link",onClick:this.handleLater},"Maybe Later"),u.createElement(s.A,{className:"ac-banner-link-button",appearance:"link",onClick:this.handleNever},"No Thanks")))),e&&u.createElement(c.A,null,u.createElement(o.A,{onClose:this.handleLater,heading:"Send Survey",shouldCloseOnEscapePress:!1},u.createElement(l.Ay,{name:"pmf-collector",onSubmit:this.handleFeedback},(e=>u.createElement("form",{...e.formProps},u.createElement(i.A,{label:h,isRequired:!1,id:"q1",name:"q1",value:this.state.q1Value,validate:p.Ef},(e=>u.createElement(d.A,{...e.fieldProps,options:t,onChange:p.cy(e.fieldProps.onChange,this.updateQ1)}))),u.createElement(i.A,{label:g,isRequired:!1,id:"q2",name:"q2"},(e=>u.createElement("div",null,u.createElement("textarea",{...e.fieldProps,style:{width:"100%",display:"block"},className:"ac-textarea",rows:3})))),u.createElement(i.A,{label:y,isRequired:!1,id:"q3",name:"q3"},(e=>u.createElement("div",null,u.createElement("textarea",{...e.fieldProps,style:{width:"100%",display:"block"},className:"ac-textarea",rows:3})))),u.createElement(i.A,{label:E,isRequired:!1,id:"q4",name:"q4"},(e=>u.createElement("div",null,u.createElement("textarea",{...e.fieldProps,style:{width:"100%",display:"block"},className:"ac-textarea",rows:3})))),u.createElement(r.A,{actions:{}},u.createElement("div",{style:{display:"inline-flex",marginRight:"4px",marginLeft:"4px;"}},u.createElement(s.A,{type:"submit",className:"ac-button",isDisabled:void 0===this.state.q1Value},"Submit")),u.createElement("div",{style:{display:"inline-flex",marginRight:"4px",marginLeft:"4px;"}},u.createElement(s.A,{className:"ac-button",onClick:this.handleLater},"Cancel"))),u.createElement("div",{style:{height:"20px"}})))))))}}}}]);